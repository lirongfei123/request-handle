"use strict";function _interopDefault(t){return t&&"object"==typeof t&&"default"in t?t.default:t}var qs=_interopDefault(require("qs")),axios=_interopDefault(require("axios")),__assign=function(){return(__assign=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var s in e=arguments[n])Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t}).apply(this,arguments)};function getAjax(t){var r=__assign({baseURL:"/",transformRequest:[function(t){return t}],transformResponse:[function(t){return t}],headers:{"X-Requested-With":"XMLHttpRequest"},timeout:3e5,withCredentials:!1,responseType:"json",responseEncoding:"utf8",maxContentLength:2e3,validateStatus:function(t){return 200<=t&&t<300},maxRedirects:15},t);return function(t){return new Promise(function(e,n){axios(__assign({},r,t)).then(function(t){e(t)},function(t){n(t)})})}}var getResponseHelper=function(t,e){return{success:function(t){return e._setSuccess(t),e},empty:function(t){return e._setEmpty(t),e},error:function(t){return e._setError(t),e},reject:function(t){Promise.reject(t)}}},Result=function(){function t(){}return Object.defineProperty(t.prototype,"success",{get:function(){return"success"===this.status},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"error",{get:function(){return"error"===this.status},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return"empty"===this.status},enumerable:!0,configurable:!0}),t.prototype._setSuccess=function(t){this.status="success",this.data=t},t.prototype._setError=function(t){this.status="error",this.data=t},t.prototype._setEmpty=function(t){this.status="empty",this.data=t},t.prototype.ifSuccess=function(t){this.success&&t(this.data)},t.prototype.ifError=function(t){this.error&&t(this.data)},t.prototype.ifEmpty=function(t){this.empty&&t(this.data)},t}(),InitRequest=function(){function t(t,e){this.config=t,this.requestConfig=e,this.ajax=getAjax(e)}return t.prototype.get=function(t,e,n){return this.http(__assign({url:t,method:"get",params:e},n))},t.prototype.post=function(t,e,n){return this.http(__assign({url:t,method:"post",data:qs.stringify(e)},n))},t.prototype.http=function(u){var c=this,t=new Promise(function(s){var o=new Result,i=getResponseHelper(t,o);c.ajax(u).then(function(t){if(c.config.common.transformResponse(t,i),o.success&&c.config.childrens&&0<c.config.childrens.length){for(var e=0,n=c.config.childrens.length;e<n;e++){var r=c.config.childrens[e];if("[object RegExp]"===Object.prototype.toString.call(r.url)){if(r.url.test(u.url))return r.transformResponse(o.data,i),void s(o)}else if(r.url===u.url)return r.transformResponse.call(o.data,i),void s(o)}s(o)}else s(o)}).catch(function(t){i.error(t),s(o)})});return t},t}();function initRequest(t,e){var n=new InitRequest(t,e);return{get:n.get.bind(n),post:n.post.bind(n),http:n.http.bind(n)}}module.exports=initRequest;
